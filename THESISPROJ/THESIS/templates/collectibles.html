  <!DOCTYPE html>
  <html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Collections</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/collectibles.css') }}">
  </head>
  <body>

    <body>
      <div class="tab-sections">
        <!-- Medals Section -->
        <div class="tab-slide active" id="medals-section">
                <div class="grid" id="medals-grid">
                    <!-- Medals content will be dynamically inserted here -->
            </div>
            <button class="nav-btn right" onclick="showSection('skins-section')">&#9654;</button>
        </div>
    
        <!-- Skins Section (Moved inside tab-sections) -->
        <div class="tab-slide" id="skins-section">
          <div class="overlay-content">
            <div class="skins-container">
              <div class="skin-display">
                <!-- Main Skin Image -->
                <img id="skin-image" src="" alt="Equip Skin" class="skin-image" />
                <!-- Secondary Image -->
                <div class="mirror" alt="mirror"></div> 
              </div>
                <button class="carousel-btn prev-btn" id="prev-skin-btn"></button>
                <button class="carousel-btn next-btn" id="next-skin-btn"></button>
              <!-- Equip Button -->
              <button class="equip-btn" id="equip-btn"></button>
            </div>
          </div>
          <button class="nav-btn left" onclick="showSection('medals-section')">&#9664;</button>
        </div>

        
      </div>
    </body>
    



    
    
  
    
    
    


    <script>
      let currentIndex = 0;
      const sections = ['medals-section', 'skins-section'];
    
      function showSection(targetId) {
        const current = document.getElementById(sections[currentIndex]);
        const nextIndex = sections.indexOf(targetId);
        const next = document.getElementById(targetId);
    
        // Remove active from current and add slide out class
        current.classList.remove('active');
        current.classList.add(nextIndex > currentIndex ? 'out-left' : 'out-right');
    
        // Reset next slide classes
        next.classList.remove('out-left', 'out-right');
        next.classList.add('active');
    
        currentIndex = nextIndex;
      }
    </script>
    
      
    
    
    
      
    <script>
      const maps = ['multiplication', 'addition', 'subtraction', 'division', 'counting', 'comparison', 'numerals', 'placevalue'];
      const stages = [1, 2, 3];
      const medalsGrid = document.getElementById('medals-grid');
    
      async function loadRewards() {
        for (const map of maps) {
          for (const stage of stages) {
            try {
              const res = await fetch(`/get_stage_reward?map=${map}&stage=${stage}`);
              const reward = await res.json();
    
              if (reward.error) continue;
    
              // Identify which type of image is present
              const [type, path] = Object.entries(reward)[0];
              const id = `${map}-stage${stage}-claimed`;
    
              const badgeDiv = document.createElement('div');
              badgeDiv.className = 'squarebadge';
              badgeDiv.id = id;
    
              const img = document.createElement('img');
              img.src = path;
              img.alt = `${type}`;
              img.className = 'badge-image';
    
              // Check if claimed from the server
              const claimCheck = await fetch('/check_reward_claimed', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ map, stage })
              });
    
              const claimResult = await claimCheck.json();
              const claimed = claimResult.claimed;
    
              if (!claimed) {
                img.style.filter = 'grayscale(100%)';
                img.style.opacity = '0.3';
              }
    
              badgeDiv.appendChild(img);
              medalsGrid.appendChild(badgeDiv);
            } catch (err) {
              console.error(`Error loading reward for ${map} stage ${stage}:`, err);
            }
          }
        }
      }
    
      loadRewards();
    </script>
    
    

  <script>
document.addEventListener('DOMContentLoaded', function () {
    const skins = [
        { id: 'default-skin', src: '/static/images/gameimg/rewardimg/skins/idle.png' },
        { id: 'multiplication-stage3-skin', src: '/static/images/gameimg/rewardimg/skins/idle1.png' },
        { id: 'addition-stage3-skin', src: '/static/images/gameimg/rewardimg/skins/idle2.png' },
        { id: 'subtraction-stage3-skin', src: '/static/images/gameimg/rewardimg/skins/idle3.png' },
        { id: 'division-stage3-skin', src: '/static/images/gameimg/rewardimg/skins/idle4.png' },
        { id: 'counting-stage3-skin', src: '/static/images/gameimg/rewardimg/skins/idle5.png' },
        { id: 'comparison-stage3-skin', src: '/static/images/gameimg/rewardimg/skins/idle6.png' },
        { id: 'numerals-stage3-skin', src: '/static/images/gameimg/rewardimg/skins/idle7.png' },
        { id: 'placevalue-stage3-skin', src: '/static/images/gameimg/rewardimg/skins/idle8.png' }
    ];

    const skinImage = document.getElementById('skin-image');
    const prevSkinBtn = document.getElementById('prev-skin-btn');
    const nextSkinBtn = document.getElementById('next-skin-btn');
    const equipBtn = document.getElementById('equip-btn');

    let currentSkinIndex = 0;

    // Initialize default skin
    if (!localStorage.getItem('default-skin')) {
        localStorage.setItem('default-skin', 'claimed');
    }

    // Set equipped skin from localStorage or default to first skin
    let currentEquippedSkin = localStorage.getItem('equippedCharacterId') || 'default-skin';
    localStorage.setItem('equippedCharacterId', currentEquippedSkin);

    // Function to update the display of the equipped skin
    function updateSkinDisplay() {
        const skin = skins[currentSkinIndex];
        const isClaimed = skin.id === 'default-skin' || localStorage.getItem(skin.id) === 'claimed';

        skinImage.src = skin.src;

        // Remove all previous skin-specific classes
        skinImage.classList.remove(...skinImage.classList);

        // Add the new skin-specific class based on the index
        skinImage.classList.add(`skin-${currentSkinIndex + 1}`);  // Add skin-1, skin-2, etc.

        // Make skin grayscale and low opacity if not acquired
        if (isClaimed) {
            skinImage.style.filter = 'none';
            skinImage.style.opacity = '1';
        } else {
            skinImage.style.filter = 'grayscale(100%)';
            skinImage.style.opacity = '0.3';
        }

        // Show "Equip" button only if skin is claimed
        equipBtn.classList.remove('equip', 'equipped', 'locked');

        if (!isClaimed) {
            equipBtn.classList.add('locked');
            equipBtn.disabled = true;
        } else if (currentEquippedSkin === skin.id) {
            equipBtn.classList.add('equipped');
            equipBtn.disabled = true;
        } else {
            equipBtn.classList.add('equip');
            equipBtn.disabled = false;
        }
    }

    // Equip the selected skin
    function equipSkin(skinId) {
        const selectedSkin = skins.find(skin => skin.id === skinId);
        if (!selectedSkin) {
            console.error("Selected skin not found:", skinId);
            return;
        }

        // Save the skin ID to localStorage
        localStorage.setItem('equippedCharacterId', selectedSkin.id);

        // Update display immediately
        currentEquippedSkin = selectedSkin.id;
        updateSkinDisplay();

        // Apply the selected skin to the player's character
        const player = document.getElementById("player-idle");
        if (player) {
            player.src = selectedSkin.src;
        }

        console.log("Skin equipped:", selectedSkin.src);
    }

    // Update to show next skin in carousel
    function showNextSkin() {
        currentSkinIndex = (currentSkinIndex + 1) % skins.length;
        updateSkinDisplay();
    }

    // Update to show previous skin in carousel
    function showPrevSkin() {
        currentSkinIndex = (currentSkinIndex - 1 + skins.length) % skins.length;
        updateSkinDisplay();
    }

    // Add event listeners for buttons
    nextSkinBtn.addEventListener('click', showNextSkin);
    prevSkinBtn.addEventListener('click', showPrevSkin);

    // Add event listener for the Equip button
    equipBtn.addEventListener('click', function () {
        const selectedSkin = skins[currentSkinIndex];
        equipSkin(selectedSkin.id);
    });

    // Initialize display
    updateSkinDisplay();
});

  </script>

    

    
    


    
    









    
  </body>
  </html>
